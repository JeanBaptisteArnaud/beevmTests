/*
 * Memory.h
 *
 *  Created on: 14 janv. 2016
 *      Author: jbapt
 */

#ifndef MEMORY_H_
#define MEMORY_H_

#include "GCSpace.h"

namespace Bee {

class Memory {
	static Memory * singleton;

public:
	Memory();
	GCSpace * growIfNeeded(ulong size);
	ulong 	* obtainFreeSpaceAndAllocate(ulong size);
	static Memory * current() {
		if(!singleton){
			singleton = new Memory;
			return singleton;
		}
protected:
	GCSpace currentSpace;
	unsigned long * spaces;
	GCSpace * collectedSpaces;
	GCSpace nextSpace;
	GCSpaceInfo allocateWithoutFinalization(ulong);

	GCSpace * acquireMoreSpace();
	GCSpace * createNextSpace();
	void addSpace(GCSpace *);
	void addCollectedSpace(GCSpace *);
	//Collector
};


}



#endif /* MEMORY_H_ */
